<script src="#(ctx)/static/common/js/jquery.autocomplete.js"></script>
<script src="#(ctx)/static/common/js/pn_data.js"></script>
<script src="#(ctx)/static/common/js/pn_ac.js"></script>
<link rel="stylesheet" type="text/css" href="#(ctx)/static/common/css/pn_ac.css">
<div class="well well-sm" id="contactWell" style="background-color: white;">
    <form class="form-horizontal" id="cardInfoForm" method="post">
        <input type="hidden" id="cardId" name="cardId" value="#(card.id??'')">
        <fieldset>
            <legend class="text-center header">投保人信息</legend>

            <div class="success text-center"
                 style="display: none;color: black !important;font-size: 18px;font-family: 'nowaybold';"></div>
            <div class="form-group">
                <div class="col-md-6">
                    <label>投保人类型</label>
                    <select class="form-control" name="type" id="type" onchange="typeChange(this.value)">
                        <option value="1">个人</option>
                        <option value="2">企业</option>
                    </select>
                </div>
            </div>
            <div class="form-group">
                <div class="col-md-6">
                    <label>证件类型</label>
                    <select class="form-control"  id="certType-1">
                        #for(x : certTypeList )
                        <option value="#(x.id)">#(x.title)</option>
                        #end
                    </select>
                    <select class="form-control"  id="certType-2" style="display: none">
                        #for(x : companyCertTypeList )
                        <option value="#(x.id)">#(x.title)</option>
                        #end
                    </select>

                </div>

                <div class="col-md-6">
                    <label>证件号</label>
                    <input id="certCode" name="certCode" type="text" onchange="checkBirth(this.value)"
                           class="form-control" required>
                </div>
            </div>
            <div class="form-group">
                <div class="col-md-6">
                    <label>投保人/公司名称</label>
                    <input id="name" name="name" type="text"
                           class="form-control" required>
                </div>
                <div class="col-md-6">
                    <label>联系人</label>
                        <input id="linkName" name="linkName" type="text"
                               class="form-control" required>
                </div>
            </div>


            <div class="form-group">
                <div class="col-md-6">
                    <label>手机号</label>
                    <input id="tel" name="tel" type="text" class="form-control"
                           required>
                </div>
                <div class="col-md-6">
                    <label>EMAIL</label>
                    <input id="email" name="email" type="text"
                           class="form-control">
                </div>
            </div>
            <div class="form-group">
                <div class="col-md-12">
                    <label>地址</label>
                    <textarea class="form-control" id="address" name="address"
                              rows="5"></textarea>
                </div>
            </div>


        </fieldset>

        <fieldset>
            <legend class="text-center header">被投保车辆信息</legend>
            <div class="form-group">
                <div class="col-md-6">
                    <label>车辆类型</label>
                    <select class="form-control" name="carType" id="carType">
                        #for(x : carTypeList )
                        <option value="#(x.id)">#(x.title)</option>
                        #end
                    </select>
                </div>
                <div class="col-md-6">
                    <label>使用性质</label>
                    <select class="form-control" name="carProp" id="carProp">
                        <option value="1">非营运</option>
                        <option value="2">营运</option>
                    </select>
                </div>

            </div>
            <div class="form-group">
                <div class="col-md-6">
                    <label>座位数</label>
                    <select id="seatCount" name="seatCount" class="form-control">
                        #for(x : [2..50])
                        <option value="#(x)">#(x)</option>
                        #end
                    </select>
                </div>
                <div class="col-md-6">
                    <label>发动机号</label>
                    <input id="engineNum" name="engineNum" type="text"
                           class="form-control" required>
                </div>
            </div>
            <div class="form-group">
                <div class="col-md-6">
                    <label>车架子号</label>
                    <input id="frameNum" name="frameNum" type="text"
                           class="form-control" required>
                </div>
                <div class="col-md-6">
                    <label>车牌号</label>
                    <input id="plateNum" name="plateNum" type="text" maxlength="7"
                           class="form-control" required>
                </div>
            </div>
        </fieldset>
    </form>
    <script>

        $(function () {
            pnInit('plateNum',pn_data);
        });

        const ctx = $('#ctx').val();
        const cardCode='#(card.code)'
        function formCheck() {
            let ret = undefined;
            let type = $("#type").val();
            let certType_1 = $("#CertType-1").val();
            let certType_2 = $("#CertType-2").val();
            let certType=type=='1'?certType_1:certType_2
            let certCode = $("#certCode").val();
            let name = $("#name").val();
            let linkName = $("#linkName").val();
            let email = $("#email").val();
            let tel = $("#tel").val();
            let address = $("#address").val();
            if (Bee.StringUtils.isBlank(certCode)) {
                layer.alert('证件号不能为空', {icon: 5})
                return ret;
            }
            if (Bee.StringUtils.isBlank(name)) {
                layer.alert('投保人/公司名称不能为空', {icon: 5})
                return ret;
            }
            if (Bee.StringUtils.isBlank(tel)) {
                layer.alert('联系电话不能为空', {icon: 5})
                return ret;
            }

            if (Bee.StringUtils.isBlank(linkName)) {
                layer.alert('联系人不能为空', {icon: 5})
                return ret;
            }

            if (Bee.StringUtils.isNotBlank(email)) {
                if (!Bee.EmailUtils.isEmail(email)) {
                    layer.alert('投保人EMAIL格式不正确', {icon: 5})
                    return ret;
                }
            }

            let carType=$('#carType').val();
            let carProp=$('#carProp').val();
            let seatCount=$('#seatCount').val();
            let engineNum=$('#engineNum').val();
            let frameNum=$('#frameNum').val();
            let plateNum=$('#plateNum').val();

            if (Bee.StringUtils.isBlank(engineNum)) {
                layer.alert('发动机号不能为空', {icon: 5})
                return ret;
            }
            if (Bee.StringUtils.isBlank(frameNum)) {
                layer.alert('车架号不能为空', {icon: 5})
                return ret;
            }
            if (Bee.StringUtils.isBlank(plateNum)) {
                layer.alert('车牌号不能为空', {icon: 5})
                return ret;
            }



            ret = {};
            ret['cardCode'] = cardCode;
            ret['type'] = type;
            ret['certType'] = certType;
            ret['certCode'] = certCode;
            ret['name'] = name;
            ret['linkName'] = linkName;
            ret['email'] = email;
            ret['tel'] = tel;
            ret['address'] = address;
            ret['carType'] = carType;
            ret['carProp'] = carProp;
            ret['seatCount']=seatCount;
            ret['engineNum']=engineNum;
            ret['frameNum']=frameNum;
            ret['plateNum']=plateNum;
            return ret;


        }
        function typeChange(val) {

            if(val=='1'){
                $("#certType-2").hide();
                $("#certType-1").show();
            }else if(val=='2'){
                $("#certType-2").show();
                $("#certType-1").hide();
            }
        }


    </script>
</div>
